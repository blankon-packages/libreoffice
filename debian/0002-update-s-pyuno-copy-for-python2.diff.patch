From d1ba27679704a2cff4f66aea0adea4008d3dfff4 Mon Sep 17 00:00:00 2001
From: Rene Engelhard <rene@debian.org>
Date: Wed, 31 Jul 2013 21:51:07 +0200
Subject: [PATCH 2/3] update s/pyuno-copy-for-python2.diff

---
 changelog                           |    2 +-
 patches/pyuno-copy-for-python2.diff |   18 ++++++++++--------
 2 files changed, 11 insertions(+), 9 deletions(-)

diff --git a/changelog b/changelog
index 82693d0..99b6907 100644
--- a/changelog
+++ b/changelog
@@ -1,4 +1,4 @@
-libreoffice (1:4.1.1~rc1~git20130725-1) UNRELEASED; urgency=low
+libreoffice (1:4.1.1~rc1~git20130731-1) UNRELEASED; urgency=low
 
   * new upstream snapshot
 
diff --git a/patches/pyuno-copy-for-python2.diff b/patches/pyuno-copy-for-python2.diff
index 3d274fc..679cf2c 100644
--- a/patches/pyuno-copy-for-python2.diff
+++ b/patches/pyuno-copy-for-python2.diff
@@ -54,7 +54,7 @@ diff -urN pyuno/Library_py2uno.mk py2uno/Library_py2uno.mk
 +# vim:set noet sw=4 ts=4:
 --- /dev/null	2012-11-27 20:03:56.000000000 +0100
 +++ py2uno/Library_py2uno_wrapper.mk	2012-11-27 17:57:31.000000000 +0100
-@@ -0,0 +1,47 @@
+@@ -0,0 +1,48 @@
 +# -*- Mode: makefile-gmake; tab-width: 4; indent-tabs-mode: t -*-
 +#
 +# This file is part of the LibreOffice project.
@@ -85,9 +85,10 @@ diff -urN pyuno/Library_py2uno.mk py2uno/Library_py2uno.mk
 +# libs (loaded though RTLD_GLOBAL libpyuno.so) may resolve that symbol to e.g.
 +# cppu, because they happen to see that before libstdc++; so the requirement has
 +# always been that RTLD_LOCAL-loaded pyuno.so wrapper implicitly load into the
-+# process as little as possible:
-+$(eval $(call gb_Library_add_ldflags,pyuno_wrapper,-nostdlib))
-+$(eval $(call gb_Library_add_libs,pyuno_wrapper,-lc))
++# process as little as possible.
++# To ensure that pyuno.so does not link against libstdc++ the dynamic link
++# command invokes gcc and not g++ if there are only C objects, so
++# don't add any C++ objects here!
 +
 +ifeq ($(filter DRAGONFLY FREEBSD NETBSD OPENBSD MACOSX,$(OS)),)
 +
@@ -244,7 +245,7 @@ diff -urN pyuno/Library_pyuno.mk py2uno/Library_pyuno.mk
 -# vim:set noet sw=4 ts=4:
 --- pyuno/Library_pyuno_wrapper.mk	2012-11-27 17:57:31.000000000 +0100
 +++ /dev/null	2012-11-27 20:03:56.000000000 +0100
-@@ -1,47 +0,0 @@
+@@ -1,48 +0,0 @@
 -# -*- Mode: makefile-gmake; tab-width: 4; indent-tabs-mode: t -*-
 -#
 -# This file is part of the LibreOffice project.
@@ -275,9 +276,10 @@ diff -urN pyuno/Library_pyuno.mk py2uno/Library_pyuno.mk
 -# libs (loaded though RTLD_GLOBAL libpyuno.so) may resolve that symbol to e.g.
 -# cppu, because they happen to see that before libstdc++; so the requirement has
 -# always been that RTLD_LOCAL-loaded pyuno.so wrapper implicitly load into the
--# process as little as possible:
--$(eval $(call gb_Library_add_ldflags,pyuno_wrapper,-nostdlib))
--$(eval $(call gb_Library_add_libs,pyuno_wrapper,-lc))
+-# process as little as possible.
+-# To ensure that pyuno.so does not link against libstdc++ the dynamic link
+-# command invokes gcc and not g++ if there are only C objects, so
+-# don't add any C++ objects here!
 -
 -ifeq ($(filter DRAGONFLY FREEBSD NETBSD OPENBSD MACOSX,$(OS)),)
 -
-- 
1.7.10.4

